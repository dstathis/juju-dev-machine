#!/usr/bin/env python3

import argparse

def run(cmd):
    return subprocess.run(cmd.split(), check=True)

def parse_args():
    parser = argparse.ArgumentParser()
    parser.add_argument('--kube', action='store_true',
                        help='Install microk8s and initialize it as a cloud')
    return parser.parse_args()

def main():
    args = parse_args()
    run('sudo apt-get update')
    run('sudo apt-get dist-upgrade')
    run('sudo snap install juju --classic')
    run('sudo snap install lxd')
    run('lxd init --auto')
    run('juju bootstrap localhost')
    if args.kube:
        run('sudo snap install microk8a --classic')
        run('microk8s status --wait-ready')



if __name__ == '__main__':
    main()
